{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"businessId\"],\n  _excluded2 = [\"businessId\", \"id\"];\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { collection, addDoc, updateDoc, deleteDoc, doc, getDocs, query, where, orderBy } from 'firebase/firestore';\nimport { db, auth } from \"../config/firebase\";\nvar PRODUCTS_COLLECTION = 'products';\nexport var productService = {\n  getBusinessProducts: function () {\n    var _getBusinessProducts = _asyncToGenerator(function* (businessId) {\n      try {\n        console.log('=== PRODUCT SERVICE: Cargando productos ===');\n        console.log('Business ID:', businessId);\n        var q = query(collection(db, PRODUCTS_COLLECTION), where('businessId', '==', businessId));\n        var querySnapshot = yield getDocs(q);\n        var products = [];\n        querySnapshot.forEach(function (doc) {\n          products.push(_objectSpread({\n            id: doc.id\n          }, doc.data()));\n        });\n        products.sort(function (a, b) {\n          return a.name.localeCompare(b.name);\n        });\n        console.log('Productos cargados:', products.length);\n        return products;\n      } catch (error) {\n        console.error('Error getting products:', error);\n        throw error;\n      }\n    });\n    function getBusinessProducts(_x) {\n      return _getBusinessProducts.apply(this, arguments);\n    }\n    return getBusinessProducts;\n  }(),\n  addProduct: function () {\n    var _addProduct = _asyncToGenerator(function* (businessId, productData) {\n      try {\n        console.log('=== PRODUCT SERVICE: Agregando producto ===');\n        console.log('Datos del producto:', productData);\n        console.log('Usuario actual en Firebase:', auth.currentUser);\n        var _ = productData.businessId,\n          cleanProductData = _objectWithoutProperties(productData, _excluded);\n        var productToSave = _objectSpread(_objectSpread({}, cleanProductData), {}, {\n          businessId: businessId,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        });\n        console.log('Guardando en Firestore:', productToSave);\n        var docRef = yield addDoc(collection(db, PRODUCTS_COLLECTION), productToSave);\n        console.log('Producto guardado exitosamente con ID:', docRef.id);\n        return docRef.id;\n      } catch (error) {\n        console.error('Error adding product:', error);\n        console.error('Error code:', error.code);\n        console.error('Error message:', error.message);\n        throw error;\n      }\n    });\n    function addProduct(_x2, _x3) {\n      return _addProduct.apply(this, arguments);\n    }\n    return addProduct;\n  }(),\n  updateProduct: function () {\n    var _updateProduct = _asyncToGenerator(function* (productId, productData) {\n      try {\n        console.log('=== PRODUCT SERVICE: Actualizando producto ===');\n        console.log('Product ID:', productId);\n        console.log('Datos del producto:', productData);\n        var _ = productData.businessId,\n          __ = productData.id,\n          cleanProductData = _objectWithoutProperties(productData, _excluded2);\n        var productRef = doc(db, PRODUCTS_COLLECTION, productId);\n        yield updateDoc(productRef, _objectSpread(_objectSpread({}, cleanProductData), {}, {\n          updatedAt: new Date()\n        }));\n        console.log('Producto actualizado exitosamente');\n      } catch (error) {\n        console.error('Error updating product:', error);\n        throw error;\n      }\n    });\n    function updateProduct(_x4, _x5) {\n      return _updateProduct.apply(this, arguments);\n    }\n    return updateProduct;\n  }(),\n  deleteProduct: function () {\n    var _deleteProduct = _asyncToGenerator(function* (productId) {\n      try {\n        yield deleteDoc(doc(db, PRODUCTS_COLLECTION, productId));\n      } catch (error) {\n        console.error('Error deleting product:', error);\n        throw error;\n      }\n    });\n    function deleteProduct(_x6) {\n      return _deleteProduct.apply(this, arguments);\n    }\n    return deleteProduct;\n  }(),\n  updateProductAvailability: function () {\n    var _updateProductAvailability = _asyncToGenerator(function* (productId, available) {\n      try {\n        var productRef = doc(db, PRODUCTS_COLLECTION, productId);\n        yield updateDoc(productRef, {\n          available: available,\n          updatedAt: new Date()\n        });\n      } catch (error) {\n        console.error('Error updating product availability:', error);\n        throw error;\n      }\n    });\n    function updateProductAvailability(_x7, _x8) {\n      return _updateProductAvailability.apply(this, arguments);\n    }\n    return updateProductAvailability;\n  }(),\n  getAvailableProducts: function () {\n    var _getAvailableProducts = _asyncToGenerator(function* () {\n      try {\n        var q = query(collection(db, PRODUCTS_COLLECTION), where('available', '==', true), orderBy('name'));\n        var querySnapshot = yield getDocs(q);\n        var products = [];\n        querySnapshot.forEach(function (doc) {\n          products.push(_objectSpread({\n            id: doc.id\n          }, doc.data()));\n        });\n        return products;\n      } catch (error) {\n        console.error('Error getting available products:', error);\n        throw error;\n      }\n    });\n    function getAvailableProducts() {\n      return _getAvailableProducts.apply(this, arguments);\n    }\n    return getAvailableProducts;\n  }()\n};\nexport default productService;","map":{"version":3,"names":["collection","addDoc","updateDoc","deleteDoc","doc","getDocs","query","where","orderBy","db","auth","PRODUCTS_COLLECTION","productService","getBusinessProducts","_getBusinessProducts","_asyncToGenerator","businessId","console","log","q","querySnapshot","products","forEach","push","_objectSpread","id","data","sort","a","b","name","localeCompare","length","error","_x","apply","arguments","addProduct","_addProduct","productData","currentUser","_","cleanProductData","_objectWithoutProperties","_excluded","productToSave","createdAt","Date","updatedAt","docRef","code","message","_x2","_x3","updateProduct","_updateProduct","productId","__","_excluded2","productRef","_x4","_x5","deleteProduct","_deleteProduct","_x6","updateProductAvailability","_updateProductAvailability","available","_x7","_x8","getAvailableProducts","_getAvailableProducts"],"sources":["D:/HARBOR/RAPIFLOW/src/services/productService.js"],"sourcesContent":["import { \n  collection, \n  addDoc, \n  updateDoc, \n  deleteDoc, \n  doc, \n  getDocs, \n  query, \n  where, \n  orderBy \n} from 'firebase/firestore';\nimport { db, auth } from '../config/firebase';\n\nconst PRODUCTS_COLLECTION = 'products';\n\nexport const productService = {\n  // Obtener todos los productos de un negocio\n  async getBusinessProducts(businessId) {\n    try {\n      console.log('=== PRODUCT SERVICE: Cargando productos ===');\n      console.log('Business ID:', businessId);\n      \n      const q = query(\n        collection(db, PRODUCTS_COLLECTION),\n        where('businessId', '==', businessId)\n      );\n      const querySnapshot = await getDocs(q);\n      const products = [];\n      querySnapshot.forEach((doc) => {\n        products.push({ id: doc.id, ...doc.data() });\n      });\n      \n      // Ordenar por nombre en el cliente\n      products.sort((a, b) => a.name.localeCompare(b.name));\n      \n      console.log('Productos cargados:', products.length);\n      return products;\n    } catch (error) {\n      console.error('Error getting products:', error);\n      throw error;\n    }\n  },\n\n  // Agregar un nuevo producto\n  async addProduct(businessId, productData) {\n    try {\n      console.log('=== PRODUCT SERVICE: Agregando producto ===');\n      console.log('Datos del producto:', productData);\n      console.log('Usuario actual en Firebase:', auth.currentUser);\n      \n      // Crear una copia sin businessId duplicado\n      const { businessId: _, ...cleanProductData } = productData;\n      \n      const productToSave = {\n        ...cleanProductData,\n        businessId,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      };\n      \n      console.log('Guardando en Firestore:', productToSave);\n      const docRef = await addDoc(collection(db, PRODUCTS_COLLECTION), productToSave);\n      console.log('Producto guardado exitosamente con ID:', docRef.id);\n      return docRef.id;\n    } catch (error) {\n      console.error('Error adding product:', error);\n      console.error('Error code:', error.code);\n      console.error('Error message:', error.message);\n      throw error;\n    }\n  },\n\n  // Actualizar un producto\n  async updateProduct(productId, productData) {\n    try {\n      console.log('=== PRODUCT SERVICE: Actualizando producto ===');\n      console.log('Product ID:', productId);\n      console.log('Datos del producto:', productData);\n      \n      // Crear una copia sin businessId duplicado si existe\n      const { businessId: _, id: __, ...cleanProductData } = productData;\n      \n      const productRef = doc(db, PRODUCTS_COLLECTION, productId);\n      await updateDoc(productRef, {\n        ...cleanProductData,\n        updatedAt: new Date()\n      });\n      \n      console.log('Producto actualizado exitosamente');\n    } catch (error) {\n      console.error('Error updating product:', error);\n      throw error;\n    }\n  },\n\n  // Eliminar un producto\n  async deleteProduct(productId) {\n    try {\n      await deleteDoc(doc(db, PRODUCTS_COLLECTION, productId));\n    } catch (error) {\n      console.error('Error deleting product:', error);\n      throw error;\n    }\n  },\n\n  // Actualizar disponibilidad de un producto\n  async updateProductAvailability(productId, available) {\n    try {\n      const productRef = doc(db, PRODUCTS_COLLECTION, productId);\n      await updateDoc(productRef, {\n        available,\n        updatedAt: new Date()\n      });\n    } catch (error) {\n      console.error('Error updating product availability:', error);\n      throw error;\n    }\n  },\n\n  // Obtener productos disponibles de todos los negocios (para clientes)\n  async getAvailableProducts() {\n    try {\n      const q = query(\n        collection(db, PRODUCTS_COLLECTION),\n        where('available', '==', true),\n        orderBy('name')\n      );\n      const querySnapshot = await getDocs(q);\n      const products = [];\n      querySnapshot.forEach((doc) => {\n        products.push({ id: doc.id, ...doc.data() });\n      });\n      return products;\n    } catch (error) {\n      console.error('Error getting available products:', error);\n      throw error;\n    }\n  }\n};\n\nexport default productService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}